
name: Deploy to EC2

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: self-hosted

    steps:
    - name: Checkout code
      uses: actions/checkout@v3
    - name: install npm
      run: |
         sudo apt install nodejs -y
         
    - name: Install dependencies
      run: |
         sudo apt install npm -y

    - name: Install PM2 globally
      run: sudo npm install -g pm2 -y

    - name: Start app with PM2
      run: 
        pm2 start server.js --name my-app
